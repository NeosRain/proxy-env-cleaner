name: Test Suite

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  test:
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [ubuntu-latest, windows-latest]
        python-version: ['3.10', '3.11', '3.12']

    steps:
    - uses: actions/checkout@v4

    - name: Set up Python ${{ matrix.python-version }}
      uses: actions/setup-python@v5
      with:
        python-version: ${{ matrix.python-version }}

    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
        pip install pytest

    - name: Run tests
      run: |
        python -c "import sys; print('Python version:', sys.version)"
        python -c "from src.utils.platform_utils import is_windows, is_linux; print(f\\\"Platform check - Windows: {is_windows()}, Linux: {is_linux()}\\\")"
        python -c "from src.utils.config import get_config_dir; print(f\\\"Config dir: {get_config_dir()}\\\")"
        # GUI import test only on Windows due to libEGL.so.1 issue on Linux
        if [ "${{ matrix.os }}" != "ubuntu-latest" ]; then
          python -c "import src.main; print('Main module import successful')"
        else
          echo "Skipping GUI import test on Linux due to libEGL.so.1 dependency issue"
        fi
        # Add more comprehensive tests as needed